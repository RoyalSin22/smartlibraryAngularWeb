

<main class="book-detail-container" *ngIf="libro">
  <a class="back-link" (click)="volverCatalogo()">
    <i class="fas fa-arrow-left"></i> Volver al Catálogo
  </a>

  <section class="book-info-main">
    <div class="cover-area">
      <img
        [src]="libro.portada || 'assets/images/placeholder.png'"
        [alt]="libro.titulo"
        class="book-cover-large"
      >
      <button
        class="reserve-btn btn-primary-gradient"
        [disabled]="!libro.disponible"
        (click)="reservarLibro()"
      >
        <i class="fas fa-bookmark"></i>
        {{ libro.disponible ? 'Reserva Ahora' : 'No Disponible' }}
      </button>
    </div>

    <div class="info-area">
      <h1 class="book-title">{{ libro.titulo }}</h1>
      <p class="book-author">{{ libro.autor }}</p>

      <div class="metadata">
        <span class="rating">
          <i
            *ngFor="let star of getStars(libro.rating || 4)"
            [class]="star.type === 'full' ? 'fas fa-star' : star.type === 'half' ? 'fas fa-star-half-alt' : 'far fa-star'"
          ></i>
          ({{ libro.rating || 4 }}/5)
        </span>
        <span class="genre-tag">{{ libro.categoria }}</span>
        <span class="availability" [class.available]="libro.disponible">
          <i [class]="libro.disponible ? 'fas fa-check-circle' : 'fas fa-times-circle'"></i>
          {{ libro.disponible ? 'Disponible' : 'No Disponible' }}
        </span>
      </div>

      <div class="synopsis-card">
        <h2>Sinopsis del Libro</h2>
        <p>
          {{ libro.sinopsis || libro.descripcion || 'Sin descripción disponible.' }}
        </p>
        <p class="isbn-info">
          <strong>ISBN:</strong> {{ libro.isbn }} |
          <strong>Páginas:</strong> {{ libro.paginas || 'N/A' }} |
          <strong>Editorial:</strong> {{ libro.editorial }}
        </p>
        <p class="copies-info">
          <strong>Copias disponibles:</strong> {{ libro.copiasDisponibles }} de {{ libro.copias }}
        </p>
      </div>

      <div class="options-bar">
        <button class="action-btn" (click)="compartir()">
          <i class="fas fa-share-alt"></i> Compartir
        </button>
        <button class="action-btn" (click)="anadirALista()">
          <i class="fas fa-plus"></i> Añadir a Lista
        </button>
        <button class="action-btn" (click)="dejarOpinion()">
          <i class="fas fa-comments"></i> Dejar Opinión
        </button>
      </div>
    </div>
  </section>

  <section class="recommendations-section" *ngIf="recomendaciones.length > 0">
    <h2><i class="fas fa-book-reader"></i> Otros que te gustarán</h2>
    <div class="recommendations-list">
      <div
        class="rec-card"
        *ngFor="let libro of recomendaciones"
        (click)="verDetalle(libro.id)"
      >
        <img
          [src]="libro.portada || 'assets/images/placeholder.png'"
          [alt]="libro.titulo"
          class="rec-cover"
        >
        <p class="rec-title">{{ libro.titulo }}</p>
        <p class="rec-author">{{ libro.autor }}</p>
      </div>
    </div>
  </section>
</main>

<div class="loading" *ngIf="!libro">
  <i class="fas fa-spinner fa-spin"></i>
  <p>Cargando libro...</p>
</div>
